{{extend 'templates/grandy1.html'}}
<div class="container marg50">
	<div class="row">
		<div class="col-lg-8">

{{for row in rows:}}
<div class="well">
  <table>
    <tr>
      <td width="200px">
      <a href="{{=URL('default','productdetails',args=[row.id])}}">
	<img src="{{=URL('download',args=row.image)}}" width="200px"/></a>
      </td>
      <td>
	<h2>{{=row.name}}</h2>
	<form action="{{=URL('cart/add')}}" data-target="#cart">
	  <div class="input-append h4">
	    {{=SELECT(*[OPTION(r.detail, ' ¥',r.best_price, _value=r.id) for r in row.inventory],**dict(_name='id'))}}
	    <input type="submit" class="btn btn-success" value="加入购物车"/>
	  </div>
	</form>
	{{=MARKMIN(row.description_short)}}
<!-- 	{{if row.description_long:}}
	<div class="hidden toggable">
	  {{=MARKMIN(row.description_long)}}
	</div>
	{{pass}}
 -->      </td>
    </tr>
  </table>
</div>
{{pass}}

{{vars=request.vars}}
{{vars.update({'page':page-1})}}
{{if page>0:}}<a class="btn" href="{{=URL(args=request.args,vars=vars)}}">Previous</a>{{pass}}
{{vars.update({'page':page+1})}}
{{if len(rows)==20:}}<a class="btn" href="{{=URL(args=request.args,vars=vars)}}">Next</a>{{pass}}
</div> <!-- end of left -->
		<div class="col-lg-4">
			<div class="row">
<!-- 
				<script type="text/javascript">
					 $('#addtocart').click(function(event){
				        alert('谢谢惠顾，商品已加入购物车!');
				        // Do whatever else...
				    });
				</script>
				</div>
 
		      <p class="widget_text"><a href="{{=URL('default','cart',args=['show'])}}">{{=LOAD('default','cart/show',vars=dict(editable=request.function!='pay'),ajax=True,target='cart')}}</a>
		      </p> -->
		      <h4>商品类目</h4>
			  <ul class="categories">
			   {{=MENU(response.menu, _class='nav' ,li_class='',ul_class='categories')}}
			  </ul>     
		</div> <!--end of col right -->
</div>
</div>
<script>
jQuery(function(){
  jQuery('[data-target]').each(function(){var t=jQuery(this); t.submit(function(){ jQuery.post(t.attr('action'),t.serialize(),function(data){jQuery(t.attr('data-target')).html(data);}); return false; }); });
  jQuery('.toggable').each(function(){var t=jQuery(this); jQuery('<button class="btn btn-info">More</button>').insertBefore(t).click(function(){t.slideToggle();});});
});
</script>
